name: Update and check subpath exports in the npm test project

inputs:
  header:
    description: Header for this scenario

  jq-operation:
    description: The operation altering the package.json descriptor

runs:
  using: composite
  steps:
    - shell: bash
      run: echo "ðŸŽ­${{inputs.header}}"

    - name: Run the requested jq operation on package.json
      shell: bash
      working-directory: tests/npm-package
      run: |
        jq '${{ inputs.jq-operation }}' package.json > package.json.temp
        mv package.json.temp package.json

        echo "ðŸ”ŽThe 'exports' field is:"
        jq -C '.exports' package.json

    - uses: ./actions/check-subpath-exports
      with:
        project-directory: tests/npm-package
