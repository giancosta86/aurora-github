name: Upload release assets
description: Uploads one or more asset files to a GitHub release.

inputs:
  release-tag:
    description: The tag of the target release.

  files:
    description: The relative paths of the asset files to upload.

  overwrite:
    description: Overwrite existing assets in the release.
    default: true

  source-directory:
    description: Directory containing the files.
    default: .

runs:
  using: composite
  steps:
    - uses: giancosta86/aurora-github/actions/setup-elvish-context@v10.3.0

    - shell: elvish {0}
      working-directory: ${{ inputs.source-directory }}
      run: |
        use aurora-github/core
        use aurora-github/release-assets

        release-assets:publish [
          &release-tag=(core:require-input release-tag '${{ inputs.release-tag }}')
          &files=(core:require-input files '${{ inputs.files }}')
          &overwrite=(core:require-input overwrite '${{ inputs.overwrite }}')
        ]
      env:
        GH_TOKEN: ${{ github.token }}
